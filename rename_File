import os

def rename_files_in_folder(folder_path):
    # Check if the path exists and is a folder
    if not os.path.exists(folder_path):
        print(f"Error: The path '{folder_path}' does not exist.")
        return
    if not os.path.isdir(folder_path):
        print(f"Error: The path '{folder_path}' is not a folder. Please provide a valid folder path.")
        return

    #  List all files in the folder (ignore subdirectories)
    files = [f for f in os.listdir(folder_path) if os.path.isfile(os.path.join(folder_path, f))]

    #  Handle the case where the folder is empty
    if not files:
        print("The folder is empty. No files to rename.")
        return

    #  Sort the files sequentially
    files.sort()

    #  Rename the files sequentially
    print("Renaming files...")
    for index, file_name in enumerate(files, start=1):
        # Get the full original path
        original_path = os.path.join(folder_path, file_name)

        # Extract the file extension
        file_extension = os.path.splitext(file_name)[1]

        # Create the new file name
        new_name = f"{index}{file_extension}"
        new_path = os.path.join(folder_path, new_name)

        try:
            # Rename the file
            os.rename(original_path, new_path)
            print(f"File '{file_name}' renamed to '{new_name}'")
        except PermissionError:
            print(f"Error: Unable to rename file '{file_name}' due to permission issues.")
        except Exception as e:
            print(f"Error: Could not rename file '{file_name}'. Reason: {e}")

    print("Renaming completed.")

# Main program execution
if __name__ == "__main__":
    # Step 6: Take the folder path as input from the user
    folder_path = input("Please enter the path to the folder: ").strip()

    # Call the function to rename files
    rename_files_in_folder(folder_path)
